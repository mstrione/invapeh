{"version":3,"sources":["../../es6/observables/IteratorObservable.js"],"names":[],"mappings":"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","file":"IteratorObservable.js","sourcesContent":["import Observable from '../Observable';\nimport { root } from '../util/root';\nimport $$iterator from '../util/Symbol_iterator';\nimport tryCatch from '../util/tryCatch';\nimport { errorObject } from '../util/errorObject';\nexport default class IteratorObservable extends Observable {\n    constructor(iterator, project, thisArg, scheduler) {\n        super();\n        this.iterator = iterator;\n        this.project = project;\n        this.thisArg = thisArg;\n        this.scheduler = scheduler;\n    }\n    static create(iterator, project, thisArg, scheduler) {\n        if (iterator == null) {\n            throw new Error('iterator cannot be null.');\n        }\n        if (project && typeof project !== 'function') {\n            throw new Error('When provided, `project` must be a function.');\n        }\n        return new IteratorObservable(iterator, project, thisArg, scheduler);\n    }\n    static dispatch(state) {\n        const { index, hasError, thisArg, project, iterator, subscriber } = state;\n        if (hasError) {\n            subscriber.error(state.error);\n            return;\n        }\n        let result = iterator.next();\n        if (result.done) {\n            subscriber.complete();\n            return;\n        }\n        if (project) {\n            result = tryCatch(project).call(thisArg, result.value, index);\n            if (result === errorObject) {\n                state.error = errorObject.e;\n                state.hasError = true;\n            }\n            else {\n                subscriber.next(result);\n                state.index = index + 1;\n            }\n        }\n        else {\n            subscriber.next(result.value);\n            state.index = index + 1;\n        }\n        if (subscriber.isUnsubscribed) {\n            return;\n        }\n        this.schedule(state);\n    }\n    _subscribe(subscriber) {\n        let index = 0;\n        const project = this.project;\n        const thisArg = this.thisArg;\n        const iterator = getIterator(Object(this.iterator));\n        const scheduler = this.scheduler;\n        if (scheduler) {\n            subscriber.add(scheduler.schedule(IteratorObservable.dispatch, 0, {\n                index, thisArg, project, iterator, subscriber\n            }));\n        }\n        else {\n            do {\n                let result = iterator.next();\n                if (result.done) {\n                    subscriber.complete();\n                    break;\n                }\n                else if (project) {\n                    result = tryCatch(project).call(thisArg, result.value, index++);\n                    if (result === errorObject) {\n                        subscriber.error(errorObject.e);\n                        break;\n                    }\n                    subscriber.next(result);\n                }\n                else {\n                    subscriber.next(result.value);\n                }\n                if (subscriber.isUnsubscribed) {\n                    break;\n                }\n            } while (true);\n        }\n    }\n}\nconst maxSafeInteger = Math.pow(2, 53) - 1;\nclass StringIterator {\n    constructor(str, idx = 0, len = str.length) {\n        this.str = str;\n        this.idx = idx;\n        this.len = len;\n    }\n    [$$iterator]() { return (this); }\n    next() {\n        return this.idx < this.len ? {\n            done: false,\n            value: this.str.charAt(this.idx++)\n        } : {\n            done: true,\n            value: undefined\n        };\n    }\n}\nclass ArrayIterator {\n    constructor(arr, idx = 0, len = toLength(arr)) {\n        this.arr = arr;\n        this.idx = idx;\n        this.len = len;\n    }\n    [$$iterator]() { return this; }\n    next() {\n        return this.idx < this.len ? {\n            done: false,\n            value: this.arr[this.idx++]\n        } : {\n            done: true,\n            value: undefined\n        };\n    }\n}\nfunction getIterator(o) {\n    const i = o[$$iterator];\n    if (!i && typeof o === 'string') {\n        return new StringIterator(o);\n    }\n    if (!i && o.length !== undefined) {\n        return new ArrayIterator(o);\n    }\n    if (!i) {\n        throw new TypeError('Object is not iterable');\n    }\n    return o[$$iterator]();\n}\nfunction toLength(o) {\n    let len = +o.length;\n    if (isNaN(len)) {\n        return 0;\n    }\n    if (len === 0 || !numberIsFinite(len)) {\n        return len;\n    }\n    len = sign(len) * Math.floor(Math.abs(len));\n    if (len <= 0) {\n        return 0;\n    }\n    if (len > maxSafeInteger) {\n        return maxSafeInteger;\n    }\n    return len;\n}\nfunction numberIsFinite(value) {\n    return typeof value === 'number' && root.isFinite(value);\n}\nfunction sign(value) {\n    let valueAsNumber = +value;\n    if (valueAsNumber === 0) {\n        return valueAsNumber;\n    }\n    if (isNaN(valueAsNumber)) {\n        return valueAsNumber;\n    }\n    return valueAsNumber < 0 ? -1 : 1;\n}\n//# sourceMappingURL=IteratorObservable.js.map"]}