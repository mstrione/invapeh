{"version":3,"sources":["../../es6/operators/zip-support.js"],"names":[],"mappings":"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","file":"zip-support.js","sourcesContent":["import Subscriber from '../Subscriber';\nimport tryCatch from '../util/tryCatch';\nimport { errorObject } from '../util/errorObject';\nimport OuterSubscriber from '../OuterSubscriber';\nimport subscribeToResult from '../util/subscribeToResult';\nimport $$iterator from '../util/Symbol_iterator';\nconst isArray = Array.isArray;\nexport class ZipOperator {\n    constructor(project) {\n        this.project = project;\n    }\n    call(subscriber) {\n        return new ZipSubscriber(subscriber, this.project);\n    }\n}\nexport class ZipSubscriber extends Subscriber {\n    constructor(destination, project, values = Object.create(null)) {\n        super(destination);\n        this.index = 0;\n        this.iterators = [];\n        this.active = 0;\n        this.project = (typeof project === 'function') ? project : null;\n        this.values = values;\n    }\n    _next(value) {\n        const iterators = this.iterators;\n        const index = this.index++;\n        if (isArray(value)) {\n            iterators.push(new StaticArrayIterator(value));\n        }\n        else if (typeof value[$$iterator] === 'function') {\n            iterators.push(new StaticIterator(value[$$iterator]()));\n        }\n        else {\n            iterators.push(new ZipBufferIterator(this.destination, this, value, index));\n        }\n    }\n    _complete() {\n        const iterators = this.iterators;\n        const len = iterators.length;\n        this.active = len;\n        for (let i = 0; i < len; i++) {\n            let iterator = iterators[i];\n            if (iterator.stillUnsubscribed) {\n                iterator.subscribe(iterator, i);\n            }\n            else {\n                this.active--; // not an observable\n            }\n        }\n    }\n    notifyInactive() {\n        this.active--;\n        if (this.active === 0) {\n            this.destination.complete();\n        }\n    }\n    checkIterators() {\n        const iterators = this.iterators;\n        const len = iterators.length;\n        const destination = this.destination;\n        // abort if not all of them have values\n        for (let i = 0; i < len; i++) {\n            let iterator = iterators[i];\n            if (typeof iterator.hasValue === 'function' && !iterator.hasValue()) {\n                return;\n            }\n        }\n        let shouldComplete = false;\n        const args = [];\n        for (let i = 0; i < len; i++) {\n            let iterator = iterators[i];\n            let result = iterator.next();\n            // check to see if it's completed now that you've gotten\n            // the next value.\n            if (iterator.hasCompleted()) {\n                shouldComplete = true;\n            }\n            if (result.done) {\n                destination.complete();\n                return;\n            }\n            args.push(result.value);\n        }\n        const project = this.project;\n        if (project) {\n            let result = tryCatch(project).apply(this, args);\n            if (result === errorObject) {\n                destination.error(errorObject.e);\n            }\n            else {\n                destination.next(result);\n            }\n        }\n        else {\n            destination.next(args);\n        }\n        if (shouldComplete) {\n            destination.complete();\n        }\n    }\n}\nclass StaticIterator {\n    constructor(iterator) {\n        this.iterator = iterator;\n        this.nextResult = iterator.next();\n    }\n    hasValue() {\n        return true;\n    }\n    next() {\n        const result = this.nextResult;\n        this.nextResult = this.iterator.next();\n        return result;\n    }\n    hasCompleted() {\n        const nextResult = this.nextResult;\n        return nextResult && nextResult.done;\n    }\n}\nclass StaticArrayIterator {\n    constructor(array) {\n        this.array = array;\n        this.index = 0;\n        this.length = 0;\n        this.length = array.length;\n    }\n    [$$iterator]() {\n        return this;\n    }\n    next(value) {\n        const i = this.index++;\n        const array = this.array;\n        return i < this.length ? { value: array[i], done: false } : { done: true };\n    }\n    hasValue() {\n        return this.array.length > this.index;\n    }\n    hasCompleted() {\n        return this.array.length === this.index;\n    }\n}\nclass ZipBufferIterator extends OuterSubscriber {\n    constructor(destination, parent, observable, index) {\n        super(destination);\n        this.parent = parent;\n        this.observable = observable;\n        this.index = index;\n        this.stillUnsubscribed = true;\n        this.buffer = [];\n        this.isComplete = false;\n    }\n    [$$iterator]() {\n        return this;\n    }\n    // NOTE: there is actually a name collision here with Subscriber.next and Iterator.next\n    //    this is legit because `next()` will never be called by a subscription in this case.\n    next() {\n        const buffer = this.buffer;\n        if (buffer.length === 0 && this.isComplete) {\n            return { done: true };\n        }\n        else {\n            return { value: buffer.shift(), done: false };\n        }\n    }\n    hasValue() {\n        return this.buffer.length > 0;\n    }\n    hasCompleted() {\n        return this.buffer.length === 0 && this.isComplete;\n    }\n    notifyComplete() {\n        if (this.buffer.length > 0) {\n            this.isComplete = true;\n            this.parent.notifyInactive();\n        }\n        else {\n            this.destination.complete();\n        }\n    }\n    notifyNext(outerValue, innerValue, outerIndex, innerIndex) {\n        this.buffer.push(innerValue);\n        this.parent.checkIterators();\n    }\n    subscribe(value, index) {\n        this.add(subscribeToResult(this, this.observable, this, index));\n    }\n}\n//# sourceMappingURL=zip-support.js.map"]}